<head>
 <script src="calcEngine.js"></script>
 <script src="JQuery/jquery-3.1.0.min.js"></script>
 <link href="css/style.css" rel="stylesheet">
</head>

<body>
<div class = "container">
  <div class="display"></div>

  <div class="result"></div>

  <div class="test"></div>

  <div class="numbers">
    <ul class = "list_number">
      <li> <button type="button" class = "button_number" id="number">7</button> </li>
      <li> <button type="button" class = "button_number" id="number">8</button></li>
      <li> <button type="button" class = "button_number" id="number">9</button></li>
      <li> <button type="button" class = "button">/</button></li>
      <li> <button type="button" class = "button">Tan</button></li>
      <li> <button type="button" class = "button">PI</button></li>
    </ul>
  </div>
  <div class="numbers">
    <ul class = "list_number">
      <li> <button type="button" class = "button_number" id="number">4</button> </li>
      <li> <button type="button" class = "button_number" id="number">5</button></li>
      <li> <button type="button" class = "button_number" id="number">6</button></li>
      <li> <button type="button" class = "button">*</button></li>
      <li> <button type="button" class = "button">^</button></li>
      <li> <button type="button" class = "button">Cos</button></li>

    </ul>
  </div>
  <div class="numbers">
    <ul class = "list_number">
      <li> <button type="button" class = "button_number" id="number">1</button> </li>
      <li> <button type="button" class = "button_number" id="number">2</button></li>
      <li> <button type="button" class = "button_number" id="number">3</button></li>
      <li> <button type="button" class = "button">-</button></li>
      <li> <button type="button" class = "button">ANS</button></li>
      <li> <button type="button" class = "button">Sin</button></li>
      <li> <button type="button" class = "button">(</button></li>
      <li> <button type="button" class = "button">)</button></li>

    </ul>
  </div>
  <div class="numbers">
    <ul class = "list_number">
      <!-- <li> <button type="button" class = "button">Shift</button></li>-->
      <li> <button type="button" class = "button">0</button> </li>
      <li> <button type="button" class = "button">.</button></li>
      <li> <button type="button" class = "button">=</button></li>
      <li> <button type="button" class = "button">+</button></li>
      <li> <button type="button" class = "button">+/-</button></li>
      <li> <button type="button" class = "button">CA</button></li>
      <li> <button type="button" class = "button"><-</button></li>



    </ul>
  </div>


</div>
</body>

<script>
var display = $('.display');
var result = $('.result');
var test = $('.test');
var clearfag = 0;
var string_count = 0;
var display_expression = [];

var buffer = [];
var dictionary = [
  {
    char : ['0','1','2','3','4','5','6','7','8','9'],
    data : {
      'type' : 'number'
    }
  },
  {
    char : ['+','-','*','/'],
    data : {
      'type' : 'operator'
    }
  },
  {
    char : ['('],
    data : {
      'type' : 'begin-bracket'
    }
  },
  {
    char : [')'],
    data : {
      'type' : 'end-bracket'
    }
  },
  {
    char : ['^'],
    data : {
      'type' : 'functionTypeA',
      'function' : "Math.pow",
    }
  },
  {
    char : ['Sin'],
    data : {
      'type' : 'functionTypeB',
      'function' : "Math.sin",
    }
  },
  {
    char : ['Cos'],
    data : {
      'type' : 'functionTypeB',
      'function' : "Math.cos",
    }
  },
  {
    char : ['Tan'],
    data : {
      'type' : 'functionTypeB',
      'function' : "Math.tan",
    }
  },
  {
    char : ['PI'],
    data : {
      'type' : 'functionTypeC',
      'function' : "Math.PI",
    }
  },
  {
    char : ['CA'],
    data : {
      'type' : 'Clear'
    }
  },
  {
    char : ['<-'],
    data : {
      'type' : 'Clear'
    }
  }
];
function findInDictionary(char) {
  // ^ is pass into this function
  var output = false;
  var temp_expression = '';
  for (var i=0;i<dictionary.length;i++) {
    var characters = dictionary[i].char;

    if (characters.indexOf(char) > -1) {

      output = dictionary[i].data;

      break;
    }
  }
  return output;
}
$('button').on('click', function(){
  var temp_expression = '';
  var i = $(this).text();
  var currentKey = findInDictionary(i);
  console.log("length of buffer is " + buffer.length);
  if (buffer.length != 0) {
    console.log("I am in buffer length check if else");
    var lastKey = buffer[buffer.length-1];
    console.log(lastKey);
  }
  else {
    var lastKey = false;
  }

    /*if (currentKey.type == 'operator') {
      if (lastKey.type == 'operator' || lastKey.type == 'functionTypeA') {

        buffer.pop();
        display_expression.pop();
        test.text(temp_expression);
        for (var i = 0; i < display_expression.length; i++) {
        temp_expression =  display_expression[i] + temp_expression;
        }
        display.text(temp_expression);
        temp_expression = [];
      }
    }
  }*/
  buffer.push(currentKey)

  switch (i) {
    case '=':
      result.text(myMathlib.calculate());
      display_expression = [];
      clearfag = 1;
      //test.text(clearfag);
      break;

    case 'CA':
      myMathlib.hit(i);
      display.text("");
      break;
    case '<-':
      myMathlib.hit(i);
      display_expression.pop();
      //test.text("temp is " + display_expression);
      for (var counting = 0; counting < display_expression.length; counting++) {
        temp_expression = temp_expression + display_expression[counting];
        //-test.text(temp_expression);
      }
      display.text(temp_expression);
      string_count = string_count-1;
      temp_expression = "";
      break;
    default:
     if (clearfag == 1) {
       display.text("");
       clearfag = 0;
     }

     if (lastKey != false) {
       console.log(" != is working");

     }
      //test.text(clearfag);
      myMathlib.hit(i);
      var n_to_s = i.toString();
      display.text(display.text() + n_to_s);
      display_expression.push(n_to_s);
      test.text("display_expression is " + display_expression);

      break;
  }
});

</script>
